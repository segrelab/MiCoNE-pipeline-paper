%!TEX root = ../main.tex

\section*{Discussion}

  % \subsection*{Why \ac{micone}?}

  Co-occurrence associations in microbial communities help identify important interdependencies that may drive microbial community structure and organization.
  A myriad of tools and methods have been developed for different parts of the workflow for inference of co-occurrence networks from 16S rRNA data.
  Our analysis shows that networks generated using different combinations of tools and approaches are significantly different from each other, highlighting the need for a clear assessment of the source of variability and for tools that provide the most robust and accurate results.
  Our newly developed integrated software for the inference of co-occurrence networks from 16S rRNA data, \ac{micone}, is a freely customizable and user-friendly pipeline that allows users to compare networks generated by multiple possible combinations of tools and parameters.
  Importantly, in addition to revisiting the test cases presented in this work, users will be able to explore the effect of various tool combinations on their own datasets of interest.
  The \ac{micone} pipeline is built in a modular fashion; its plug-and-play architecture enables users to add new tools and steps, either using existing packages that were not examined in the present work or those developed in the future.
  The easy-to-use nature, the configurability and modular nature of the \ac{micone} package enables users to start and end the pipeline at any point in the workflow, and to run parts of the pipeline in isolation.
  The \ac{micone} Python package provides functions and methods to perform detailed analysis of the count matrices and the co-occurrence networks.
  Additionally, the inferred networks are exported to a custom JSON format (see Supplementary), but can also be exported to Cytoscape~\cite{shannonCytoscapeSoftwareEnvironment2003}, GML~\cite{himsoltGMLPortableGraph2010}, and many other popular formats via the \ac{micone} Python package.

  While several tools/workflows such as \ac{qiime2}~\cite{bolyenReproducibleInteractiveScalable2019} and NetCoMi~\cite{peschelNetCoMiNetworkConstruction2020} can be used to generate co-occurrence networks from 16S sequencing data, no single tool exist that integrates the complete process of inferring microbial interaction networks from 16S sequencing reads.
  \ac{micone} is unique as it offers this functionality packaged in a workflow that can be run locally, on the compute cluster or the cloud.
  For an end user who is interested in identifying the microbial interdependencies present in a specific sequencing dataset, \ac{micone} offers a fast and reproducible way to compare and test novel hypotheses.

  % \subsection*{The default pipeline and recommended tools}

  The main outcome of this work is two-fold.
  On one hand, we transparently reveal the dependence of co-occurrence networks on tool and parameter choices, and built a tool for this purpose, enabling to more rigorously assess and compare existing networks.
  On the other hand, we take advantage of our spectrum of computational options and the availability of mock and synthetic datasets, to suggest a default standard setting, and a consensus approach, that is more likely to yield networks that are robust across multiple tool/parameter choices.
  An important caveat related to this last point is the fact that due to the lack of a universal standard for microbial interaction data, our conclusions are based on the specific datasets used in our analysis.
  While our datasets comprise several mock and synthetic datasets that cover a fairly diverse range of abundance distributions and network topologies, datasets that have drastically different distributions may require a re-assessment of the best settings through our pipeline.

  Additionally, it is worth pointing out some additional more specific conclusions stemming from the individual steps of our analysis.
  The different denoising/clustering methods differ mostly in their identification of sequences that are in low abundances.
  Hence, they do not have much of an impact on the inferred co-occurrence networks when the sequences of low abundance are removed (Figure~\ref{fig:figure_s1}).
  Comparison of inferred and expected reference sequences and their abundances in mock community datasets has allowed us to identify \ac{dada2} as the method which best recapitulates the expected sequence composition.
  For the chimera checking module, we suggest using the remove bimera method since it was developed in conjunction with \ac{dada2} and its performance does not significantly differ from uchime-denovo.
  For the current work we have decided to focus on the tools most widely used at the time of the analysis.
  Some tools which were not as widely used (e.g. dbOTU3~\cite{Olesen2017}) as well as older popular methods like mothur~\cite{Schloss2009} have not been included in the study, but could be added into the pipelines in future updated analyses.

  The choice of taxonomy database was found to be the most important factor in the inference of microbial co-occurrence networks, contributing $65.4\%$ of the total variance.
  The frequent changes in the taxonomy nomenclature coupled with the frequency of updates to the various 16S reference databases create inherent differences \cite{Balvociute2017} in taxonomy hierarchies in these databases.
  Our analysis revealed that no particular reference database performs better than the others across the different mock dataset benchmarks.
  The default reference database in the pipeline is the \ac{gg} reference database along with the ``Naive Bayes'' classifier as the query tool.
  The reason for our choice stems from the popularity of the \ac{gg} database [https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6440677/] in taxonomic studies, which would enable easy comparison across datasets.
  % TODO: Add ref: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6440677/
  However, for newer studies we recommend using SILVA database because of its size and taxonomic comprehensiveness~\cite{iiRESCRIPtReproducibleSequence2021} and since \ac{gg} has not been updated since 2013.
  Additionally, we also enable users to use custom databases~\cite{Ritari2015,iiRESCRIPtReproducibleSequence2021} with the BLAST and Naive Bayes classifiers that are incorporated into the pipeline (from \ac{qiime2}).
  % TODO: Add ref: https://pubmed.ncbi.nlm.nih.gov/32106809/
  We suggest that that choice of the database should be made based on possible reported or inferred biases in the representation of given biomes in a specific databases~\cite{Balvociute2017,iiRESCRIPtReproducibleSequence2021}.

  The \ac{op} step of the pipeline is second in its contribution to total network variance.
  This can be attributed to the large number of nodes that are added to the final networks when the filtering is turned off.
  Additionally, a very large number of nodes also decreases the accuracy of the network inference algorithms for the same sample size~\cite{peschelNetCoMiNetworkConstruction2020} and increases the computational complexity~\cite{tackmannRapidInferenceDirect2019}.
  We observe that filtering out taxa that are present in low abundances in all samples increases the proportion of taxa in common between taxonomy tables generated using different reference databases (Figure~\ref{fig:figure_s5}), providing another reason for filtering.
  We also observe that the reduction in the number of taxa leads to better agreement in the networks inferred through different methods (Figure~\ref{fig:figure_s1}).
  Moreover, filtering is necessary in order to increase the power in tests of significance when the number of taxa is much greater than the number of samples.

  The networks generated by different network inference methods show considerable differences in edge-density and connectivity.
  One reason for this is the underlying assumptions regarding sparsity, distribution and compositionality, that the algorithms make.
  The consensus network created by merging the networks inferred from the different network inference methods enables the creation of a network whose links have evidence based on multiple inference algorithms.
  We have developed two consensus algorithms to support this effort, the simple voting method and the scaled-sum method.
  Ultimately, we find that the scaled-sum method along with p-value merging (applied to the correlation-based methods) performs the best on synthetic datasets, therefore this is the default for the \ac{ni} step of the pipeline.
  The consensus algorithm not only leads to the creation of a network that has a higher number of true positives, it also decreases the variability in the networks due to choosing a different tool or parameter in any of the previous steps of the pipeline (Figure~\ref{fig:figure7}B).
  This provides the means to obtain a short list of associations, each of which, have a high probability of being present in the real interaction network
  This small set of associations could be further tested and validated experimentally to verify their plausibility.

  % \subsection*{Future directions}

  The current analyses make use of one fecal microbiome transplant dataset with healthy and autistic samples, three mock community datasets and several datasets generated by two synthetic interaction methods.
  The analyses presented in this study are specific to the datasets utilized, and due to the lack of a gold standard reference dataset for microbial interaction data, it is not possible to generalize these results to datasets with widely different microbiome profiles.
  Incorporating datasets from a broad spectrum of biomes with varying microbial distributions into \ac{micone} will likely increase the robustness and generalizability of the results from these analyses.

  The network analyses in this study are primarily at the Genus level, wherein the lowest resolution of a node is a Genus and if an entity cannot be resolved to the Genus level and next lowest taxonomic level is used (e.g. Family).
  As a consequence, two entities belonging to the same lineage where one entity is resolved to the Genus level and another is resolved to the Family level are treated as two different nodes in the network.
  Therefore, the development of a metric of overlap to compare nodes with shared lineages within and across networks could provide more biologically and phylogentically relevant comparisons.
  Further analyses could also include networks at the Species or other taxonomic levels.

  Additionally, the utilization of literature-based interactions~\cite{lima-mendezDeterminantsCommunityStructure2015a} or biological benchmark interaction data~\cite{sungGlobalMetabolicInteraction2017a} as additional sources for benchmarking.
  Furthermore, expanding the scope of the \ac{micone} pipeline to also include metagenomics sequencing data will enable an even broader access to a diverse range of datasets as well as domains of life that can be incorporated into the analysis.

  Although the pipeline currently supports changing of parameter values for the most commonly used parameters for several tools, we only use those default parameter values that are recommended by the tool creators.
  The exploration of the effects of parameter values on the inferred association networks might help optimize these values for better network inference, but these are not part of this current study.
  Additionally, despite incorporating a wide range of tools and algorithms into the \ac{micone} pipeline, there were several other tools that were omitted due time and computational constraints.
  However, the modular nature of the \ac{micone} pipeline enables easy addition of new tools and methods at any step of the workflow.
  Since there exists no ``best method'' for the various steps of 16S data analysis, especially for microbial network inference, \ac{micone} is intended to help researchers to identify the methods and algorithms that are most suitable for their datasets in an easy-to-use and reproducible manner.

  We envision that \ac{micone}, and the underlying tools and databases that help process amplicon sequencing data into co-occurrence networks, will be increasingly useful towards building large comparative analyses across studies.
  Furthermore, in the re-analysis of published networks across studies and processing methods, \ac{micone} could help understand underlying biases imposed on networks due to the selected methods.
  In summary, we believe that \ac{micone} is a useful tool for the exploration of microbial networks generated from 16S data.
  It allows for rapid, configurable and reproducible inference of microbial networks and further for the formulation of hypotheses about the role of these interactions on community composition and stability.
  Additionally, our pipeline is coupled to the MIND database and web interface for the organization and visualization of microbial networks, enabling easier comparisons across studies and datasets.
