%--------------------------------------------------------%
% Figures
%--------------------------------------------------------%

\input{sections/preamble}

% \titleformat{\subsection}[runin]{}{}{}{}[]


\title{ \huge Microbial Interaction Database pipeline - Figures draft \#2 }
\author{DK, GB, ZH, CD, KK, DS}
\date{\today}

\begin{document}

\maketitle

\begin{figure}[h]
  \centering
  \includegraphics[width=0.7\linewidth]{figure1.pdf}
  \caption{
    \textbf{The workflow of the microbial co-occurrence analysis pipeline}.
    The processes can be grouped into four major steps: \textbf{(A)} denoising and clustering, \textbf{(B)} taxonomy assignment, \textbf{(C)} OTU/ESV processing, and \textbf{(D)} network inference.
    Each step incorporates several processes, each of which in turn have several alternate algorithms for the same task (indicated by the text to the right of the blue boxes).
    \textbf{(E)} shows the average variances in the final networks contributed by each of the four groups over all the test datasets
  }
  \label{fig:main_figure}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=\linewidth]{figure2.pdf}
  \caption{
    \textbf{Comparison of representative sequences generated by the various denoising and clustering algorithms used in the workflow.}
    \textbf{(A)} The average weighted UniFrac distance between the representative sequences,
    \textbf{(B)} The average unweighted UniFrac distance,
    \textbf{(C)} The distributions of the average unweighted UniFrac distance between original sequence profile and calculated sequence profile in mock datasets (this will be replaced with a violoin plot)
  }
  \label{fig:figure2}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=\linewidth]{figure3.pdf}
  \caption{
    \textbf{Comparison of taxonomy assignments using different taxonomy reference databases}
    \textbf{(A)} Taxonomy composition of the 20 most abundant genera predicted using different taxonomy references databases: Greengenes, SILVA and NCBI.
    The legend shows the common and the unique genera among the taxonomy assignments.
    \textbf{(B)} The percentage of OTUs assigned to the same taxonomic label when using different reference databases.
    The percentage of matches are shown at various taxonomic levels.
    \textbf{(C)} The bray-curtis dissimilarity between the original taxonomy profile and calculated taxonomy profile in the mock datasets.
  }
  \label{fig:figure3}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=\linewidth]{figure4.pdf}
  \caption{
    \textbf{Networks generated using different network inference methods}.
    \textbf{(A)} The four different networks generated by different network inference methods are very dissimilar
    \textbf{(B)} The edge overlap upset plot
    \textbf{(C)} The node overlap upset plot.
  }
  \label{fig:figure4}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=\linewidth]{figure6.pdf}
  \caption{Example networks generated using our pipeline: Final consensus networks for some datasets}
  \label{fig:figure6}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.8\linewidth]{figure6.pdf}
  \caption{
    \textbf{The choice of database contributes to the most variance in the networks}.
    \textbf{(A)} The relative variance in the networks contributed by the denoising, taxonomy assignment and filtering steps.
    \textbf{(B)} The PCA plot clearly shows that the networks can be separated based on database
  }
  \label{fig:figure1}
\end{figure}


\FloatBarrier

\subsection*{Supplementary}%

\begin{figure}[h]
  \centering
  \includegraphics[width=0.67\linewidth]{figures1.pdf}
  \caption{
    \textbf{Comparison of various denoising and clustering algorithms used in the pipeline}.
    (A, B) Correlation of the abundances of the taxa that are common between the count matrices created by two different methods.
    (A) The best correlation (most similar methods) is between open-reference and denovo.
    (B) The worst correlation (least similar methods) is between open-reference and dada2.
    (C) A heatmap showing the $\mathrm{R}^2$ of all pairwise comparisons of the methods.
  }
  \label{fig:figures1}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.7\linewidth]{figures2.pdf}
  \caption{Effect of OTU processsing measures on the OTU table. This is just a placeholder}
  \label{fig:figures2}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.8\linewidth]{pdf/all_denoise_reg.pdf}
  \caption{All pairwise correlations comparing the similarity between different denoising and clustering methods}
  \label{fig:figures3}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.8\linewidth]{png/hamming_distance.png}
  \caption{The hamming distance between the networks is shown. The similarity between various methods was found to vary with the data-source used.}
  \label{fig:figures4}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.8\linewidth]{pdf/denoise_network.pdf}
  \caption{A network showing union and intersection of networks generated using certain combination of methods}
  \label{fig:figures5}
\end{figure}


\end{document}
